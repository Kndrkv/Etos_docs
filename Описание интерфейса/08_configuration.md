# Настройка конфигурации

Для перехода к настройке конфигураций в главном меню нужно перейти во вкладку «Настройки программы» и выбрать соответствующий пункт:

![Переход в настройкам конфигураций](images/08_config_01.png)

Откроется следующая форма:

![Форма настройки конфигураций](images/08_config_02.png)
 
Форма предназначена для настройки параметров работы баз данных (БД) и выполнения операций с ними.

В верхней части формы расположена панель меню:

![Панель меню настройки конфигураций](images/08_config_03.png)

Описание работы кнопок панели меню приведено в таблице ниже.

<table border="1">
<tr>
    <td align="center"><b>Вид кнопки</b></td>
    <td align="center"><b>Название</b></td>
    <td align="center"><b>Назначение</b></td>
    <td align="center"><b>«Горячие» клавиши</b></td>
</tr>
<tr>
    <td><img src="images/buttons/button_13.png"></td>
    <td>Создать новую запись</td>
    <td>Производиться очистка текущей формы и подготовка к внесению информации о новой</td>
    <td>Ctrl+N</td>
</tr>
<tr>
    <td><img src="images/buttons/button_01.png"></td>
    <td>Сохранить изменения</td>
    <td>Сохраняет изменения, сделанные в форме. Форма остается открытой</td>
    <td>Ctrl+S</td>
</tr>
<tr>
    <td><img src="images/buttons/button_14.png"></td>
    <td>Удалить запись</td>
    <td>Удаляет выбранную конфигурацию БД</td>
    <td></td>
</tr>
<tr>
    <td><img src="images/buttons/button_02.png"></td>
    <td>Обновить форму</td>
    <td>Обновляет данные о конфигурации БД и перерисовывает форму. Все несохраненные изменения будут потеряны</td>
    <td>Ctrl+R или F5</td>
</tr>
<tr>
    <td><img src="images/buttons/button_03.png"></td>
    <td>Перезагрузить форму</td>
    <td>Заново перезагружает форму и все данные в ней. Все несохраненные изменения будут потеряны</td>
    <td>Ctrl+F5 или F6</td>
</tr>
<tr>
    <td><img src="images/buttons/button_04.png"></td>
    <td>Сохранить изменения и закрыть форму</td>
    <td>Сохраняет сделанные в настройках конфигурации изменения и закрывает форму</td>
    <td>Ctrl+E</td>
</tr>
</table>

В нижней части формы расположен список имеющихся и доступных к созданию БД.

Минимальный набор баз, необходимых для работоспособности программы, включает в себя:

- Основную БД.
- Базу нарушений.
- Базу вложенных файлов.
  
Минимальный набор БД создается при установке программы, а также при создании новой конфигурации баз.

## Подключение баз данных

После установки СУБД и создания нужных баз данных, а также после установки Программы необходимо выполнить подключения к созданным БД. Для этого нужно выбрать нужную БД, нажав на ней ЛКМ. 

![Выбор типа БД](images/08_config_04.png)

Далее выбрать тип БД, указать адрес сервера, имя БД, а также логин и пароль для подключения к серверу. 

![Ввод данных для подключения к БД](images/08_config_05.png)

Аналогичные операции необходимо повторить для каждой созданной БД.

Для подключения к БД можно использовать учетную запись, под которой выполнен вход в ОС Windows, для чего необходимо выставить соответствующий флаг.

## Операции с базами данных

Форма работы с БД содержит панель меню с шестью кнопками:

![Панель меню формы настройки конфигураций](images/08_config_06.png)
 
Кнопка «Индексация» запускает соответствующую операцию с БД текущей конфигурации, что позволяет ускорить работу Программы при обращении к базам. Индексация также запускается автоматически при обновлении БД. После запуска индексации необходимо дождаться ее завершения:
 
![Результаты индексации](images/08_config_08.png)

Кнопка «Резервная копия» запускает процесс резервирования БД. Создание резервной копии баз выполняется автоматически при каждом выходе из программы.

![Сообщение об успешном резервном копировании](images/08_config_09.png)
 
При нажатии кнопки «Восстановить базу» откроется окно проводника. В нем нужно выбрать директорию с резервными копиями, из которой будет выполнено восстановление баз. 

![Выбор директории с резервными копиями БД](images/08_config_10.png)

После завершения процесса восстановления Программа выведет сообщение о его результатах:

![Сообщение об успешном выполнении восстановления БД](images/08_config_11.png)
 
Клонирование позволяет выполнить полное копирование данных из одной БД в другую. Для выполнения этой операции необходимо нажать кнопку «Клонирование» и в открывшейся форме выбрать конфигурацию, в которую будет произведено копирование. 

![Форма клонирования БД](images/08_config_12.png)

>Выбрать конфигурацию, из которой будет выполняться клонирование, нельзя. Копирование возможно только из текущей конфигурации (выбранной при запуске Программы).

Клонируемые БД нужно отметить флагами (![](images/buttons/flagon.png)), после чего нажать кнопку «Запустить процесс клонирования отмеченных баз данных» или «Запустить процесс доклонирования отмеченных баз». В последнем случае в «принимающую» БД будет выполнена запись новых и измененных данных, совпадающие записи при этом останутся без именений. Операция доклонирования экономит время, но не гарантирует идентичности БД.

Если установить флаг (![](images/buttons/flagon.png)) «Клонировать журнал событий», будет выполнено клонирование журнала событий, журнала последних изменений и журнала импорта. Эти данные не требуются для работы Программы, но помогают отслеживать стабильность ее выполнения и возникающие ошибки.

При нажатии кнопки «Восстановить администратора» будет создана учетная запись пользователя с правами администратора, если таковая отсутствовала в БД.

![Сообщение об успешном создании УЗ администратора](images/08_config_13.png)

## Состояние баз данных

При запуске Программа проверяет БД, используемые в текущей (заданной по умолчанию) конфигурации. Сведения о состоянии баз выводятся в виде отметок на «бочонках» в окне ввода данных учетной записи:

![Состояние баз данных](images/08_config_14.png)
 
Выбрать другую конфигурацию можно с помощью выпадающего списка.

Значки на бочонках могут означать следующие состояния БД:

![](images/08_config_15.png) – производится подключение к БД.

![](images/08_config_16.png) – соединение с базой установлено, производительность хорошая.

![](images/08_config_17.png) – соединение с базой установить не удалось, проверьте настройки подключения, база отсутствует по указанной строке подключения.

![](images/08_config_18.png) – соединение с базой установлено, нет прав доступа на запись в БД.

![](images/08_config_19.png) – соединение с базой установлено.

![](images/08_config_20.png) – соединение с базой установлено, для работы с новой версии БД обновите базу.

![](images/08_config_21.png) – для работы с базой данных этого типа необходимо установить соответствующий драйвер.

![](images/08_config_22.png) – не заданы настройки подключения БД.

![](images/08_config_23.png) – соединение установлено, база данных при вводе пароля будет обновлена с текущей версии до необходимой.
 
![База данных будет обновлена](images/08_config_24.png)

Также в случае успешного соединения с БД при наведении на значок базы выводиться информации о ее версии:
 
![Версия БД](images/08_config_25.png)