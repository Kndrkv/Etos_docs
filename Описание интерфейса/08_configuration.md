# Настройка конфигурации

Для перехода к настройке конфигураций в главном меню нужно перейти во вкладку «Настройки программы» и выбрать соответствующий пункт (рис.1).

<p align="center">
<img src="images/08_config_01.png"><br>
<i>Рисунок 1. Переход в настройкам конфигураций</i>
</p>

Откроется следующая форма (рис.2)

<p align="center">
<img src="images/08_config_02.png"><br>
<i>Рисунок 2. Форма настройки конфигураций</i>
</p>
 
Форма предназначена для настройки параметров работы баз данных (БД) и выполнения операций с ними.

В верхней части формы расположена панель меню (рис.3)

<p align="center">
<img src="images/08_config_03.png"><br>
<i>Рисунок 3. Панель меню настройки конфигураций</i>
</p>

Описание работы кнопок панели меню приведено в табл.1.

<table border="1">
<tr>
    <td align="center"><b>Вид кнопки</b></td>
    <td align="center"><b>Название</b></td>
    <td align="center"><b>Назначение</b></td>
    <td align="center"><b>«Горячие» клавиши</b></td>
</tr>
<tr>
    <td align="center"><img src="images/buttons/button_13.png"></td>
    <td>Создать новую запись</td>
    <td>Производиться очистка текущей формы и подготовка к внесению информации о новой</td>
    <td>Ctrl+N</td>
</tr>
<tr>
    <td align="center"><img src="images/buttons/button_01.png"></td>
    <td>Сохранить изменения</td>
    <td>Сохраняет изменения, сделанные в форме. Форма остается открытой</td>
    <td>Ctrl+S</td>
</tr>
<tr>
    <td align="center"><img src="images/buttons/button_14.png"></td>
    <td>Удалить запись</td>
    <td>Удаляет выбранную конфигурацию БД</td>
    <td></td>
</tr>
<tr>
    <td align="center"><img src="images/buttons/button_02.png"></td>
    <td>Обновить форму</td>
    <td>Обновляет данные о конфигурации БД и перерисовывает форму. Все несохраненные изменения будут потеряны</td>
    <td>Ctrl+R или F5</td>
</tr>
<tr>
    <td align="center"><img src="images/buttons/button_03.png"></td>
    <td>Перезагрузить форму</td>
    <td>Заново перезагружает форму и все данные в ней. Все несохраненные изменения будут потеряны</td>
    <td>Ctrl+F5 или F6</td>
</tr>
<tr>
    <td align="center"><img src="images/buttons/button_04.png"></td>
    <td>Сохранить изменения и закрыть форму</td>
    <td>Сохраняет сделанные в настройках конфигурации изменения и закрывает форму</td>
    <td>Ctrl+E</td>
</tr>
</table>

<p align="center"><i>Таблица 1. Назначение кнопок панели меню управления конфигураций</i></p>

В нижней части формы расположен список имеющихся и доступных к созданию БД.

Минимальный набор баз, необходимых для работоспособности программы, включает в себя:

- Основную БД.
- Базу нарушений.
- Базу вложенных файлов.
  
Минимальный набор БД создается при установке программы, а также при создании новой конфигурации баз.

## Подключение баз данных

После установки СУБД и создания нужных баз данных, а также после установки Программы необходимо выполнить подключения к созданным БД. Для этого нужно выбрать нужную БД, нажав на ней ЛКМ (рис.4).

<p align="center">
<img src="images/08_config_04.png"><br>
<i>Рисунок 4. Выбор типа БД</i>
</p>

Далее выбрать тип БД, указать адрес сервера, имя БД, а также логин и пароль для подключения к серверу (рис.5). 

<p align="center">
<img src="images/08_config_05.png"><br>
<i>Рисунок 5. Ввод данных для подключения к БД</i>
</p>

Аналогичные операции необходимо повторить для каждой созданной БД.

Для подключения к БД можно использовать учетную запись, под которой выполнен вход в ОС Windows, для чего необходимо выставить соответствующий флаг (рис.5).

## Операции с базами данных

Форма работы с БД содержит панель меню с шестью кнопками (рис.6).

<p align="center">
<img src="images/08_config_06.png"><br>
<i>Рисунок 6. Панель меню формы настройки конфигураций</i>
</p>
 
Кнопка «Индексация» запускает соответствующую операцию с БД текущей конфигурации, что позволяет ускорить работу Программы при обращении к базам. Индексация также запускается автоматически при обновлении БД. После запуска индексации необходимо дождаться ее завершения (рис.7).

<p align="center">
<img src="images/08_config_08.png"><br>
<i>Рисунок 7. Результат индексации</i>
</p>

Кнопка «Резервная копия» запускает процесс резервирования БД (рис.8). Создание резервной копии баз выполняется автоматически при каждом выходе из программы.

<p align="center">
<img src="images/08_config_09.png"><br>
<i>Рисунок 8. Сообщение об успешном резервном копировании</i>
</p>
 
При нажатии кнопки «Восстановить базу» откроется окно проводника (рис.9). В нем нужно выбрать директорию с резервными копиями, из которой будет выполнено восстановление баз. 

<p align="center">
<img src="images/08_config_10.png"><br>
<i>Рисунок 9. Выбор директории с резервными копиями БД</i>
</p>

После завершения процесса восстановления Программа выведет сообщение о его результатах (рис.10).

<p align="center">
<img src="images/08_config_11.png"><br>
<i>Рисунок 10. Сообщение об успешном выполнении восстановления БД</i>
</p>
 
Клонирование позволяет выполнить полное копирование данных из одной БД в другую. Для выполнения этой операции необходимо нажать кнопку «Клонирование» и в открывшейся форме (рис.11) выбрать конфигурацию, в которую будет произведено копирование.

<p align="center">
<img src="images/08_config_12.png"><br>
<i>Рисунок 11. Форма клонирования БД</i>
</p>

>Выбрать конфигурацию, из которой будет выполняться клонирование, нельзя. Копирование возможно только из текущей конфигурации (выбранной при запуске Программы).

Клонируемые БД нужно отметить флагами (![](images/buttons/flagon.png)), после чего нажать кнопку «Запустить процесс клонирования отмеченных баз данных» или «Запустить процесс доклонирования отмеченных баз». В последнем случае в «принимающую» БД будет выполнена запись новых и измененных данных, совпадающие записи при этом останутся без именений. Операция доклонирования экономит время, но не гарантирует идентичности БД.

Если выставить флаг (![](images/buttons/flagon.png)) «Клонировать журнал событий» (рис.11), будет выполнено клонирование журнала событий, журнала последних изменений и журнала импорта. Эти данные не требуются для работы Программы, но помогают отслеживать стабильность ее выполнения и возникающие ошибки.

При нажатии кнопки «Восстановить администратора» будет создана учетная запись пользователя с правами администратора, если таковая отсутствовала в БД (рис.12).

<p align="center">
<img src="images/08_config_13.png"><br>
<i>Рисунок 12. Сообщение об успешном создании УЗ администратора</i>
</p>

## Состояние баз данных

При запуске Программа проверяет БД, используемые в текущей (заданной по умолчанию) конфигурации. Сведения о состоянии баз выводятся в виде отметок на «бочонках» в окне ввода данных учетной записи (рис.13).

<p align="center">
<img src="images/08_config_14.png"><br>
<i>Рисунок 13. Состояние баз данных</i>
</p>
 
Выбрать другую конфигурацию можно с помощью выпадающего списка.

Значки на бочонках могут означать следующие состояния БД:

![](images/08_config_15.png) – производится подключение к БД.

![](images/08_config_16.png) – соединение с базой установлено, производительность хорошая.

![](images/08_config_17.png) – соединение с базой установить не удалось, проверьте настройки подключения, база отсутствует по указанной строке подключения.

![](images/08_config_18.png) – соединение с базой установлено, нет прав доступа на запись в БД.

![](images/08_config_19.png) – соединение с базой установлено.

![](images/08_config_20.png) – соединение с базой установлено, для работы с новой версии БД обновите базу.

![](images/08_config_21.png) – для работы с базой данных этого типа необходимо установить соответствующий драйвер.

![](images/08_config_22.png) – не заданы настройки подключения БД.

![](images/08_config_23.png) – соединение установлено, база данных при вводе пароля будет обновлена с текущей версии до необходимой (рис.14).

<p align="center">
<img src="images/08_config_24.png"><br>
<i>Рисунок 14. База данных будет обновлена</i>
</p>

Также в случае успешного соединения с БД при наведении на значок базы выводиться информации о ее версии (рис.15).

<p align="center">
<img src="images/08_config_25.png"><br>
<i>Рисунок 15. Версия БД</i>
</p>